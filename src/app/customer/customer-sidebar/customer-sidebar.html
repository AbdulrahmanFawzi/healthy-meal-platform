<aside class="customer-sidebar" [class.open]="isOpen" dir="rtl">
  <!-- Logo Section -->
  @if (branding$ | async; as branding) {
    <div class="sidebar-logo">
      <img [src]="brandingService.getLogoUrl(branding.logoUrl)" alt="Logo" class="logo-image">
      <h2 class="brand-text">{{ branding.name }}</h2>
    </div>
  } @else {
    <div class="sidebar-logo">
      <img src="assets/healthyFoodIcon.png" alt="Logo" class="logo-image">
      <h2 class="brand-text">وجباتي</h2>
    </div>
  }

  <!-- Navigation Menu -->
  <nav class="sidebar-nav">
    @for (item of menuItems; track item.route) {
      <a 
        [routerLink]="item.route" 
        routerLinkActive="active"
        class="nav-item"
        [class.active]="isActive(item.route)"
        (click)="onNavItemClick()">
        <img [src]="item.icon" [alt]="item.label" class="nav-icon">
        <span class="nav-label">{{ item.label }}</span>
      </a>
    }
  </nav>

  <!-- Subscription Remaining Card -->
  <div class="subscription-card" [ngClass]="getStatusClass()">
    <!-- Card Header -->
    <div class="card-header">
      <h3 class="card-title">المدة المتبقية للاشتراك</h3>
      <svg class="calendar-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
        <rect x="3" y="6" width="18" height="15" rx="2" stroke="#EF4444" stroke-width="2"/>
        <path d="M3 10h18" stroke="#EF4444" stroke-width="2"/>
        <path d="M8 3v4M16 3v4" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </div>

    <!-- Remaining Days Display -->
    <div class="days-display">
      <span class="days-number">{{ remainingDays }}</span>
      <span class="days-label">يوم</span>
    </div>

    <!-- Progress Bar -->
    <div class="progress-container">
      <div class="progress-track">
        <div 
          class="progress-fill" 
          [style.width.%]="progressPercent"
          [style.background-color]="getProgressBarColor()">
        </div>
      </div>
    </div>

    <!-- Bottom Status Row -->
    <div class="status-row">
      <!-- Warning (conditionally shown) -->
      @if (showWarning()) {
        <div class="warning-section">
          <svg class="warning-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="#EF4444" stroke-width="2"/>
            <path d="M12 8v4M12 16h.01" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span class="warning-text">{{ getStatusText() }}</span>
        </div>
      }
      @if (remainingDays === 0) {
        <div class="warning-section">
          <svg class="warning-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="#EF4444" stroke-width="2"/>
            <path d="M12 8v4M12 16h.01" stroke="#EF4444" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span class="warning-text">{{ getStatusText() }}</span>
        </div>
      }

      <!-- Elapsed Days -->
      <div class="elapsed-section">
        <span class="elapsed-text">انقضى {{ elapsedDays }} يوم</span>
      </div>
    </div>
  </div>

  <!-- Logout Button -->
  <div class="sidebar-footer">
    <button class="logout-btn" (click)="logout()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
        <polyline points="16 17 21 12 16 7"/>
        <line x1="21" y1="12" x2="9" y2="12"/>
      </svg>
      <span class="logout-label">تسجيل الخروج</span>
    </button>
  </div>
</aside>
